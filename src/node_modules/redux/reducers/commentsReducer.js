import { GET_COMMENTS, CLEAR_COMMENTS, ADD_COMMENT, UPDATE_COMMENT, DELETE_COMMENT } from 'redux/actions/constants'

const initialState = {
   commentsSelectedPost: null,
}

export default function commentsReducer(state = initialState, action) {
   switch (action.type) {
      case GET_COMMENTS: {
         const { data } = action.payload
         return {
            ...state,
            commentsSelectedPost: data
         }
      }
      case ADD_COMMENT: {
         const { data } = action.payload
         const newComment = { ...data }
         return {
            ...state,
            commentsSelectedPost: [...state.commentsSelectedPost, newComment]
         }
      }
      case UPDATE_COMMENT: {
         const { id, text } = action.payload
         return {
            ...state,
            commentsSelectedPost: [...state.commentsSelectedPost.map((comment) => {
               if (comment.id == id) {
                  return {
                     ...comment,
                     text
                  }
               }
               return comment
            })
            ]
         }
      }
      case DELETE_COMMENT: {
         const { id } = action.payload
         return {
            ...state, 
            commentsSelectedPost: [ ...state.commentsSelectedPost.filter(comment => comment.id !== id) ]
         }
      }
      case CLEAR_COMMENTS: {
         return initialState
      }

      default:
         return state;
   }
}