import {
   START_FETCH_POSTS,
   SUCCESS_FETCH_POSTS,
   ERROR_FETCH_POSTS,

   CREATE_NEW_POST,
   PATCH_POST,
   DELETE_POST
} from 'redux/actions/constants'

const initialState = {
   posts: null,
   error: null,
   loading: false,
}

export default function postsReducer(state = initialState, action) {
   switch (action.type) {
      case START_FETCH_POSTS: {
         return {
            ...state,
            loading: true
         }
      }
      case SUCCESS_FETCH_POSTS: {
         const { posts } = action.payload
         return {
            ...state,
            posts: posts,
            loading: false,
         }
      }
      case ERROR_FETCH_POSTS: {
         const { error } = action.payload
         return {
            ...state,
            error: error,
            loading: false,
         }
      }
      case CREATE_NEW_POST: {
         const { text, created_at, post_id, update_ad, user_id } = action.payload
         const newPost = {
            comments, text, created_at, post_id, update_ad, user_id
         }
         return {
            ...state,
            posts: [
               ...state.posts,
               newPost
            ]
         }
      }
      case PATCH_POST: {
         const { id, text, update_ad } = action.payload
         return {
            ...state,
            posts: [...state.posts.map((post) => {
               if (post.id == id) {
                  return {
                     ...post,
                     text,
                     update_ad
                  }
               }
            })]
         }
      }
      case DELETE_POST: {
         const { id } = action.payload
         return {
            ...state,
            posts: [ 
               ...state.posts.filter(post => post.id !== id) 
            ]
         }
      }
      default: {
         return state
      }
   }
}