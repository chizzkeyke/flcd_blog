import axios from 'axios'
import { getUser, getAuthUser } from 'redux/actions/user'

const token = localStorage.getItem('token')

export const fetchDataAboutUser = (id) => dispatch => {
    return axios({
        method: 'GET',
        url: `https://test.flcd.ru/api/user/${id}`,
        headers: {
            'accept': '*/*',
            'Authorization': `Bearer ${token}`,
            'Content-type': 'application/json',
        }
    })
        .then(res => {
            dispatch(getUser(res.data))
        })
        .catch(err => {
            console.log(err)
        })
}

export const fetchDataAboutCurrentUser = () => dispatch => {
    return axios({
        method: 'GET',
        url: `https://test.flcd.ru/api/user/self`,
        headers: {
            'accept': '*/*',
            'Authorization': `Bearer ${token}`,
            'Content-type': 'application/json',
        }
    })
        .then(res => {
            localStorage.setItem('userId', JSON.stringify(res.data))
            dispatch(getAuthUser(res.data))
        })
        .catch(err => {
            console.log(err)
        })
}