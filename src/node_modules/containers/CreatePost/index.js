import React, { useState } from 'react'
import { useDispatch } from 'react-redux'
import { fetchNewPost } from 'DAL/postsFetching'
import { useHistory } from 'react-router'
import './style.css'

const CreatePost = () => {
   const [text, setText] = useState('')
   const dispatch = useDispatch()
   const history = useHistory()

   const handleSubmit = e => {
      e.preventDefault()
      dispatch(fetchNewPost(text))
      setTimeout(() => {
         history.push('/myposts')
      }, 2000)
   }

   return (
      <div className='create_new_post'>
         <form className='form_new_post' onSubmit={handleSubmit}>
            <textarea placeholder='Whrite somebody...' 
                      value={text} 
                      onChange={event => setText(event.target.value)}            
            />
            <button>Create New Post</button>
         </form>
      </div>
   )
}

export default CreatePost