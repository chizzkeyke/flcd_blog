import React, { useEffect } from 'react'
import { useSelector, useDispatch } from 'react-redux'
import { getPosts } from 'DAL/postsFetching'

import Post from 'components/Post'
import Loader from 'components/Loader'

const HomePage = props => {
   const loggedIn = useSelector(state => state.auth.loggedIn)
   const posts = useSelector(state => state.post.posts)
   const dispatch = useDispatch()

   useEffect(() => {
      dispatch(getPosts())
   }, [dispatch])


   const helloTitle = () => (
      <div>
         <h1>Welcome span</h1>
      </div>
   )

   const renderPosts = () => (
      <div>
         {posts.map((post, index) => (
            <Post text={post.text} key={index} />
         ))}
      </div>
   )

   const loadigPosts = () => (
      <div>
         {posts ? renderPosts() : <Loader />}
      </div>
   )

   console.log(props.match)

   return (
      <div className='home_page'>
         {
            loggedIn
               ? loadigPosts()
               : helloTitle()
         }
      </div>
   )
}

export default HomePage










